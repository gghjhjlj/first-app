import streamlit as st
import pandas as pd
import folium
from streamlit_folium import st_folium

st.set_page_config(page_title="수도권 신도시 지도", layout="wide")

st.title("🏙️ 대한민국 수도권 신도시 분석 지도")
st.markdown("1기~3기 수도권 신도시의 개발 정보와 지도를 제공합니다.")

# 신도시 데이터
new_town_data = [
    # 1기 신도시
    {"이름": "분당", "기수": "1기", "위도": 37.3784, "경도": 127.1127, "공급호수": 95000, "면적": 19.6, "교통": "분당선, 신분당선", "기간": "1989~1996"},
    {"이름": "일산", "기수": "1기", "위도": 37.6761, "경도": 126.7479, "공급호수": 105000, "면적": 16.7, "교통": "일산선, 경의선", "기간": "1989~1996"},
    {"이름": "산본", "기수": "1기", "위도": 37.3595, "경도": 126.9339, "공급호수": 49000, "면적": 5.3, "교통": "4호선", "기간": "1989~1996"},
    {"이름": "중동", "기수": "1기", "위도": 37.5034, "경도": 126.763, "공급호수": 56000, "면적": 5.5, "교통": "7호선", "기간": "1989~1996"},
    {"이름": "평촌", "기수": "1기", "위도": 37.3921, "경도": 126.9516, "공급호수": 49000, "면적": 4.7, "교통": "4호선", "기간": "1989~1996"},

    # 2기 신도시
    {"이름": "판교", "기수": "2기", "위도": 37.395, "경도": 127.111, "공급호수": 29000, "면적": 8.9, "교통": "신분당선, 경강선", "기간": "2003~2010"},
    {"이름": "위례", "기수": "2기", "위도": 37.4703, "경도": 127.1435, "공급호수": 42000, "면적": 6.8, "교통": "8호선, 위례신사선 예정", "기간": "2008~2020"},
    {"이름": "동탄2", "기수": "2기", "위도": 37.2042, "경도": 127.1058, "공급호수": 119000, "면적": 24.3, "교통": "SRT, GTX-A 예정", "기간": "2008~2027"},
    {"이름": "김포한강", "기수": "2기", "위도": 37.628, "경도": 126.7155, "공급호수": 50000, "면적": 11.8, "교통": "김포골드라인", "기간": "2006~2015"},
    {"이름": "검단", "기수": "2기", "위도": 37.5976, "경도": 126.6694, "공급호수": 75000, "면적": 11.2, "교통": "인천1호선 연장, GTX-D 예정", "기간": "2007~2030"},

    # 3기 신도시 (선정된 지역 일부)
    {"이름": "남양주왕숙", "기수": "3기", "위도": 37.676, "경도": 127.216, "공급호수": 70000, "면적": 11.3, "교통": "GTX-B 예정", "기간": "2020~"},
    {"이름": "하남교산", "기수": "3기", "위도": 37.5395, "경도": 127.2131, "공급호수": 30000, "면적": 6.5, "교통": "지하철 3호선 예정", "기간": "2020~"},
    {"이름": "과천", "기수": "3기", "위도": 37.429, "경도": 126.989, "공급호수": 7000, "면적": 1.5, "교통": "4호선", "기간": "2020~"},
    {"이름": "고양창릉", "기수": "3기", "위도": 37.645, "경도": 126.896, "공급호수": 38000, "면적": 8.1, "교통": "GTX-A 예정", "기간": "2020~"},
    {"이름": "부천대장", "기수": "3기", "위도": 37.517, "경도": 126.777, "공급호수": 20000, "면적": 3.3, "교통": "서부광역철도 예정", "기간": "2020~"}
]

# 데이터프레임 생성
df = pd.DataFrame(new_town_data)

# 지도 생성
m = folium.Map(location=[37.5, 127.0], zoom_start=10)

for _, row in df.iterrows():
    popup_info = (
        f"<b>{row['이름']} ({row['기수']})</b><br>"
        f"공급호수: {row['공급호수']:,}호<br>"
        f"면적: {row['면적']}㎢<br>"
        f"교통: {row['교통']}<br>"
        f"개발기간: {row['기간']}"
    )
    folium.Marker(
        location=[row["위도"], row["경도"]],
        popup=popup_info,
        tooltip=row["이름"],
        icon=folium.Icon(color="blue" if row["기수"] == "1기" else "green" if row["기수"] == "2기" else "red")
    ).add_to(m)

# 지도 시각화
st.subheader("🗺️ 수도권 신도시 위치 지도")
st_folium(m, width=1000)

# 표 시각화
st.subheader("📊 신도시 종합 정보 표")
st.dataframe(df[["이름", "기수", "공급호수", "면적", "교통", "기간"]], use_container_width=True)

# 상세 정보 보기
st.subheader("🔍 신도시 상세 정보")
selected = st.selectbox("신도시를 선택하세요", df["이름"])
info = df[df["이름"] == selected].iloc[0]
st.markdown(f"### 🏙️ {info['이름']} ({info['기수']})")
st.write(f"**공급 호수:** {info['공급호수']:,}호")
st.write(f"**개발 면적:** {info['면적']}㎢")
st.write(f"**교통 여건:** {info['교통']}")
st.write(f"**개발 기간:** {info['기간']}")
